{"version":3,"sources":["../src/db.js"],"names":["callback","mongoUri","mongo","host","Promise","connect","server","socketOptions","keepAlive","then","mongooseDebug","set","collectionName","method","query","doc","inspect","err","console","log","Error"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;kBAEe,UAACA,QAAD,EAAc;AAC3B,MAAMC,WAAW,iBAAUC,KAAV,CAAgBC,IAAjC;AACA,qBAASC,OAAT;;AAEA,qBAASC,OAAT,CAAiBJ,QAAjB,EAA2B,EAAEK,QAAQ,EAAEC,eAAe,EAAEC,WAAW,CAAb,EAAjB,EAAV,EAA3B,EAA4EC,IAA5E,CACE,YAAM;AACJ,QAAI,iBAAUC,aAAd,EAA6B;AAC3B,yBAASC,GAAT,CAAa,OAAb,EAAsB,UAACC,cAAD,EAAiBC,MAAjB,EAAyBC,KAAzB,EAAgCC,GAAhC,EAAwC;AAC5D,6BAASH,cAAT,SAA2BC,MAA3B,EAAqC,eAAKG,OAAL,CAAaF,KAAb,EAAoB,KAApB,EAA2B,EAA3B,CAArC,EAAqEC,GAArE;AACD,OAFD;AAGD;AACDf;AACD,GARH,EASE,UAACiB,GAAD,EAAS;AACPC,YAAQC,GAAR,CAAYF,GAAZ;AACA,UAAM,IAAIG,KAAJ,qCAA4CnB,QAA5C,CAAN;AACD,GAZH;AAcD,C","file":"db.js","sourcesContent":["import mongoose from 'mongoose';\nimport debug from 'debug';\nimport util from 'util';\nimport bluebird from 'bluebird';\n\nimport envConfig from '../config/config';\n\nexport default (callback) => {\n  const mongoUri = envConfig.mongo.host;\n  mongoose.Promise = bluebird;\n\n  mongoose.connect(mongoUri, { server: { socketOptions: { keepAlive: 1 } } }).then(\n    () => {\n      if (envConfig.mongooseDebug) {\n        mongoose.set('debug', (collectionName, method, query, doc) => {\n          debug(`${collectionName}.${method}`, util.inspect(query, false, 20), doc);\n        });\n      }\n      callback();\n    },\n    (err) => {\n      console.log(err);\n      throw new Error(`unable to connect to database: ${mongoUri}`);\n    },\n  );\n};\n"]}